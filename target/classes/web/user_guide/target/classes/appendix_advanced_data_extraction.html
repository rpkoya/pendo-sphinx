
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Appendix - Classification - Advanced Data Extraction Examples · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="appendix_date_time.html" />
    
    
    <link rel="prev" href="appendix_using_excel_plugin.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./#top">
            
                    
                    Introductory Material for the Pendo Platform
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="./">
            
                <a href="./#support-portal">
            
                    
                    Support Portal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="./">
            
                <a href="./#administration-overview">
            
                    
                    Administration Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="readme.html">
            
                <a href="readme.html#login-page">
            
                    
                    Logging in
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="./">
            
                <a href="./#when-to-use-what-a-workspace-overview">
            
                    
                    When to Use What – A Workspace Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.5" data-path="./">
            
                <a href="./#doc-hist">
            
                    
                    Document History
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="sourcing_data.html">
            
                <a href="sourcing_data.html#top">
            
                    
                    Sourcing Data
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="sourcing_data.html">
            
                <a href="sourcing_data.html#file-systems-component">
            
                    
                    Files and Folders Component
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="sourcing_data.html">
            
                <a href="sourcing_data.html#upload-component">
            
                    
                    Uploads Component
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="sourcing_data.html">
            
                <a href="sourcing_data.html#data-sources-component">
            
                    
                    Remote Sources Component
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="metadata_1.html">
            
                <a href="metadata_1.html#top">
            
                    
                    Entities and Attributes
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="metadata_1.html">
            
                <a href="metadata_1.html#entities-component">
            
                    
                    Entities Component
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="document-set-class.html">
            
                <a href="document-set-class.html#top">
            
                    
                    Document Sets and Document Classes
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="document-set-class.html">
            
                <a href="document-set-class.html#docset-component">
            
                    
                    Document Sets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="document-set-class.html">
            
                <a href="document-set-class.html#classification">
            
                    
                    Document Classes Component
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="ocr-screens.html">
            
                <a href="ocr-screens.html#top">
            
                    
                    OCR related screens and Confidence numbers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="class-stats.html">
            
                <a href="class-stats.html#top">
            
                    
                    Classification Statistics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="unified_search.html">
            
                <a href="unified_search.html#top">
            
                    
                    Unified Search
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="appendix_high_level_behaviors.html">
            
                <a href="appendix_high_level_behaviors.html#top">
            
                    
                    Appendix - All About Grids: Sorting, Filtering, Grouping and more.
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="appendix_plugins.html">
            
                <a href="appendix_plugins.html#top">
            
                    
                    Appendix – Data Plugins - General Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="appendix_document_navigation.html">
            
                <a href="appendix_document_navigation.html#top">
            
                    
                    Appendix - Non- and Semi-Structured Document Navigation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="appendix_using_fixed_values.html">
            
                <a href="appendix_using_fixed_values.html#top">
            
                    
                    Appendix – Using Fixed Values including Approved List of Values during Classification Mapping
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="appendix_using_excel_plugin.html">
            
                <a href="appendix_using_excel_plugin.html#top">
            
                    
                    Appendix - Using the Excel Plugin for Classification
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="appendix_advanced_data_extraction.html">
            
                <a href="appendix_advanced_data_extraction.html#top">
            
                    
                    Appendix - Classification - Advanced Data Extraction Examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="appendix_date_time.html">
            
                <a href="appendix_date_time.html#top">
            
                    
                    Appendix - Date and Time Formatting and Parsing Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="appendix_api_naming.html">
            
                <a href="appendix_api_naming.html#api-naming">
            
                    
                    Appendix - API Naming
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Appendix - Classification - Advanced Data Extraction Examples</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="top">Appendix Classification - Advanced Data Extraction Examples </h1>
<ul>
<li><a href="#intro">Introduction</a></li>
<li><a href="#iterate-range">Iterating over a Range within a Document</a><ul>
<li><a href="#access-update-ent">Accessing and Updating the Entity</a></li>
<li><a href="#using-iteration">Using Iteration</a></li>
</ul>
</li>
</ul>
<h1 id="intro">Introduction </h1>
<p>This appendix will provide examples of advanced data extraction. The assumptions may include knowledge of Python and / or Groovy Scripting. The number of examples will grow over time.</p>
<h1 id="iterate-range">Iterating over a Range within a Document </h1>
<p>This example describes how to iterate over a range within a document to so that you can extract multiple rows of data and populate rows within the Target Entity.</p>
<p><img src="appendix-advanced-data-extraction/screen1.png" alt="">  </p>
<p>This capability is available using a Python Expression (Entity) which is accessed from the Edit-&gt;Mapping tab of a Classification Screen:</p>
<p><img src="appendix-advanced-data-extraction/screen2.png" alt=""></p>
<p>When you add a Python Script (Entity) mapping, you have to specify the Entity which will be populated with the results of the mapping logic. The example above shows that the mapping has been set to the entity Lease Entity.  </p>
<h2 id="defining-your-mapping-expression">Defining your Mapping Expression</h2>
<p>To build your expression, press the Edit button on the mapping tile. This will open up a Python scripting window:</p>
<p><img src="appendix-advanced-data-extraction/screen3.png" alt=""></p>
<p>Since this example is based upon extracting data from an Excel Workbook; the first thing you must do in order to begin your expression, is to import the Pendo ExcelHelper library. Enter the following code at the top of the script window:  </p>
<p><code>from com.pendosystems import ExcelHelper</code></p>
<p>Declare and initialize a variable in order to be able access the Excel plug-in functions.  </p>
<p><code># Initialize the helper</code><br><code>helper = ExcelHelper(document)</code></p>
<p>Once we have created a helper we can use it in the same way as we have in the expressions. For example, to find a specific value:  </p>
<p><code>distribution_date = helper.getWorkBook().getSheet(&quot;Retail&quot;).find(&quot;Distribution Date&quot;).rightWithContent().getValue()</code>  </p>
<h2 id="access-update-ent">Accessing and Updating the Entity </h2>
<p>In order to populate the Target Entity, you use the <em>entities.append()</em> function. The syntax of this function is the following:  </p>
<p>`Entities.append({&#x201C;attributeName&#x201D;:value, [&#x201C;attributeName&#x201D;:value],&#x2026;})``</p>
<p>Where:<br><code>attributeName</code> is the Name of the Attribute. This is the API name of the attribute as defined in the Entity, not the Descriptive Name of the attribute which appears in the mapping preview. The &apos;attributeName&apos; is also case sensitive.</p>
<p><code>Value</code>    The value that you want to assign to the Attribute.</p>
<h2 id="using-iteration">Using Iteration </h2>
<p>Now that you know how to populate an Entity, you can use any of Python&#x2019;s control structures to loop through the document and add to the entity.  </p>
<p>For the example lets just create a few entities using a range using a for loop:<br><code># Capture a value for the Distribution Date</code><br><code>distribution_date = helper.getWorkBook().getSheet(&quot;Retail&quot;).find(&quot;Distribution Date&quot;).rightWithContent().getValue()</code></p>
<p><code># Append the values to the Entity</code><br><code>for current in range(2,10):</code><br><code>entities.append({&quot;DistributionDate&quot;:distribution_date, &quot;servicer&quot;:&quot;Example&quot;, &quot;current&quot;:current })</code></p>
<p>The result of this expression would be:  </p>
<table>
<thead>
<tr>
<th>Distribution Date</th>
<th>Servicer</th>
<th>Current</th>
</tr>
</thead>
<tbody>
<tr>
<td>12/31/2013</td>
<td>Example</td>
<td>2</td>
</tr>
<tr>
<td>12/31/2013</td>
<td>Example</td>
<td>3</td>
</tr>
<tr>
<td>12/31/2013</td>
<td>Example</td>
<td>4</td>
</tr>
<tr>
<td>12/31/2013</td>
<td>Example</td>
<td>5</td>
</tr>
<tr>
<td>12/31/2013</td>
<td>Example</td>
<td>6</td>
</tr>
<tr>
<td>12/31/2013</td>
<td>Example</td>
<td>7</td>
</tr>
<tr>
<td>12/31/2013</td>
<td>Example</td>
<td>8</td>
</tr>
<tr>
<td>12/31/2013</td>
<td>Example</td>
<td>9</td>
</tr>
<tr>
<td>12/31/2013</td>
<td>Example</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>You can also use Python&#x2019;s while structure so that you can perform a test to see when the iteration should stop:<br><code>rowIndex = 1</code><br><code>while(rowIndex &lt; 3):</code><br><code>entities.append({&quot;DistributionDate&quot;:distribution_date, &quot;servicer&quot;:&quot;Example&quot;, &quot;WholesaleTotalCommitment&quot;: commitment})</code><br>    <code>rowIndex+=1</code><br>    <code>commitment = helper.getWorkBook().getSheet(&quot;Master&quot;).find(&quot;Total
    commitment&quot;).down(rowIndex).getDecimal()</code></p>
<p>The Output of this mapping would be:</p>
<table>
<thead>
<tr>
<th>Distribution Date</th>
<th>Servicer</th>
<th>Wholesale Total Commitment</th>
</tr>
</thead>
<tbody>
<tr>
<td>12/31/2013</td>
<td>Example</td>
<td>7500000000</td>
</tr>
<tr>
<td>12/31/2013</td>
<td>Example</td>
<td>2200000000</td>
</tr>
<tr>
<td>12/31/2013</td>
<td>Example</td>
<td>13000000004</td>
</tr>
</tbody>
</table>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="appendix_using_excel_plugin.html#top" class="navigation navigation-prev " aria-label="Previous page: Appendix - Using the Excel Plugin for Classification">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="appendix_date_time.html#top" class="navigation navigation-next " aria-label="Next page: Appendix - Date and Time Formatting and Parsing Options">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Appendix - Classification - Advanced Data Extraction Examples","level":"1.11","depth":1,"next":{"title":"Appendix - Date and Time Formatting and Parsing Options","level":"1.12","depth":1,"anchor":"#top","path":"appendix_date_time.md","ref":"appendix_date_time.md#top","articles":[]},"previous":{"title":"Appendix - Using the Excel Plugin for Classification","level":"1.10","depth":1,"anchor":"#top","path":"appendix_using_excel_plugin.md","ref":"appendix_using_excel_plugin.md#top","articles":[]},"dir":"ltr"},"config":{"gitbook":"3.x.x","theme":"default","variables":{},"plugins":["heading-anchors"],"pluginsConfig":{"heading-anchors":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"appendix_advanced_data_extraction.md","mtime":"2017-09-07T14:36:58.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-12-08T21:25:59.184Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.2.1/anchor.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-heading-anchors/anchor-style.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

